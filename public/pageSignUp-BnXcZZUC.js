const __vite__fileDeps=["./pageIm-Dz55Dpoz.js","./index-CvWBhmNo.js","./index-CPYeyI0a.css","./page-9xzdIDLN.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{a as u,b as r,g as _,_ as P,j as y,i as E}from"./index-CvWBhmNo.js";import{L as k}from"./loginPage-CxZlI-GA.js";import{P as N}from"./page-9xzdIDLN.js";import{I,r as f,w as A}from"./wrapEmojiText-C9ZwzJ29.js";import{P as D,a as S}from"./avatar-BjEbBb6X.js";import{B as M,I as F,a as U}from"./buttonIcon-Beq2DGJD.js";import{p as B}from"./putPreloader-XqhBclwv.js";import"./scrollable-COTa0yl_.js";let v=null;const x=async()=>{const e=new k({className:"page-signUp",withInputWrapper:!0,titleLangKey:"YourName",subtitleLangKey:"Login.Register.Subtitle"});if(r.getLoggedInInstanceIDs().length>0){const t=document.createElement("div"),a=M("close");a.addEventListener("click",async()=>{let o=r.getLoggedInInstanceIDs().find(n=>n==r.getLastInstanceId());o||(o=r.getLoggedInInstanceIDs()[0]),await r.destroyInstance(r.getActiveInstanceID()),await r.switchToInstance(o)}),t.append(a),e.container.querySelector(".auth-image").parentElement.prepend(t)}e.imageDiv.classList.add("avatar-edit"),e.title.classList.add("fullName");const l=document.createElement("canvas");l.id="canvas-avatar",l.className="avatar-edit-canvas";const L=F("cameraadd","avatar-edit-icon");e.imageDiv.append(l,L);let d;e.imageDiv.addEventListener("click",()=>{D.createPopup(S).open(l,t=>{d=t})});const h=t=>{const a=i.value||"",s=c.value||"",p=a||s?(a+" "+s).trim():"";p?f(e.title,A(p)):f(e.title,E("YourName"))},b=()=>new Promise((t,a)=>{if(!d)return t();d().then(s=>{u.managers.appProfileManager.uploadProfilePhoto(s).then(t,a)},a)}),i=new I({label:"FirstName",maxLength:70}),c=new I({label:"LastName",maxLength:64}),g=U("btn-primary btn-color-primary"),m=new _.IntlElement({key:"StartMessaging"});return g.append(m.element),e.inputWrapper.append(i.container,c.container,g),i.input.addEventListener("input",h),c.input.addEventListener("input",h),g.addEventListener("click",function(t){if(i.input.classList.contains("error")||c.input.classList.contains("error"))return!1;if(!i.value.length)return i.input.classList.add("error"),!1;this.disabled=!0;const a=i.value.trim(),s=c.value.trim(),p={phone_number:v.phone_number,phone_code_hash:v.phone_code_hash,first_name:a,last_name:s};m.update({key:"PleaseWait"});const o=B(this);u.managers.apiManager.invokeApi("auth.signUp",p).then(async n=>{switch(n._){case"auth.authorization":await u.managers.apiManager.setUser(n.user),b().finally(()=>{P(()=>import("./pageIm-Dz55Dpoz.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(w=>{w.default.mount()})});break;default:m.update({key:n._}),this.removeAttribute("disabled"),o.remove();break}}).catch(n=>{switch(this.removeAttribute("disabled"),o.remove(),n.type){default:m.update({key:n.type});break}})}),y(),new Promise(t=>{window.requestAnimationFrame(t)})},z=new N("page-signUp",!0,x,e=>{v=e,u.managers.appStateManager.pushToState("authState",{_:"authStateSignUp",authCode:e})});export{z as default};
//# sourceMappingURL=pageSignUp-BnXcZZUC.js.map
