const __vite__fileDeps=["./pageIm-Dz55Dpoz.js","./index-CvWBhmNo.js","./index-CPYeyI0a.css","./page-9xzdIDLN.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{a as w,b as s,g as v,m as L,f as y,_ as b}from"./index-CvWBhmNo.js";import{p as S}from"./putPreloader-XqhBclwv.js";import{P,a as k}from"./page-9xzdIDLN.js";import{B as E,a as _}from"./buttonIcon-Beq2DGJD.js";import{P as D,a as M,h as x}from"./htmlToSpan-Cs_vmNib.js";import{L as A}from"./loginPage-CxZlI-GA.js";import{r as N,w as T,t as B}from"./wrapEmojiText-C9ZwzJ29.js";let n;const V=()=>{const p=new A({className:"page-password",withInputWrapper:!0,titleLangKey:"Login.Password.Title",subtitleLangKey:"Login.Password.Subtitle"});if(s.getLoggedInInstanceIDs().length>0){const e=document.createElement("div"),c=E("close");c.addEventListener("click",async()=>{let a=s.getLoggedInInstanceIDs().find(I=>I==s.getLastInstanceId());a||(a=s.getLoggedInInstanceIDs()[0]),await s.destroyInstance(s.getActiveInstanceID()),await s.switchToInstance(a)}),e.append(c),p.container.querySelector(".auth-image").parentElement.prepend(e)}const o=_("btn-primary btn-color-primary"),r=new v.IntlElement({key:"Login.Next"});o.append(r.element);const t=new D({label:"LoginPassword",name:"password"});n=t.input,p.inputWrapper.append(t.container,o);let d;const u=()=>(d||(d=window.setInterval(u,1e4)),w.managers.passwordManager.getState().then(e=>{i=e,i.hint?N(t.label,x(T(i.hint))):t.setLabel()}));let i;const h=e=>{if(e&&y(e),!n.value.length){n.classList.add("error");return}const c=B([n,o],!0),m=n.value;r.update({key:"PleaseWait"});const g=S(o);t.setValueSilently(""+Math.random()),t.setValueSilently(m),w.managers.passwordManager.check(m,i).then(a=>{switch(a._){case"auth.authorization":clearInterval(d),b(()=>import("./pageIm-Dz55Dpoz.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(I=>{I.default.mount()}),l&&l.remove();break;default:o.removeAttribute("disabled"),r.update({key:a._}),g.remove();break}}).catch(a=>{switch(c(),t.input.classList.add("error"),a.type){default:r.update({key:"PASSWORD_HASH_INVALID"}),n.select();break}g.remove(),u()})};k(o,h),n.addEventListener("keypress",function(e){if(this.classList.remove("error"),r.update({key:"Login.Next"}),e.key==="Enter")return h()});const f=L.isMobile?100:166,l=new M(t,f);return p.imageDiv.append(l.container),Promise.all([l.load(),u()])},R=new P("page-password",!0,V,null,()=>{n.focus(),w.managers.appStateManager.pushToState("authState",{_:"authStatePassword"})});export{R as default};
//# sourceMappingURL=pagePassword-BUHj7bf5.js.map
