const __vite__fileDeps=["./pageIm-Dz55Dpoz.js","./index-CvWBhmNo.js","./index-CPYeyI0a.css","./page-9xzdIDLN.js","./pageSignUp-BnXcZZUC.js","./loginPage-CxZlI-GA.js","./wrapEmojiText-C9ZwzJ29.js","./buttonIcon-Beq2DGJD.js","./avatar-BjEbBb6X.js","./scrollable-COTa0yl_.js","./putPreloader-XqhBclwv.js","./pagePassword-BUHj7bf5.js","./htmlToSpan-Cs_vmNib.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{r as f,s as v,i as g,a as E,_ as m,b as l,m as S}from"./index-CvWBhmNo.js";import{P as D,a as T}from"./page-9xzdIDLN.js";import k from"./pageSignIn-CCvqSK4z.js";import{C as L,T as A}from"./codeInputField-sWPN9Xm0.js";import{r as _,l as C}from"./wrapEmojiText-C9ZwzJ29.js";import{B as w,I as O}from"./buttonIcon-Beq2DGJD.js";import"./putPreloader-XqhBclwv.js";import"./countryInputField-D8kEeBe8.js";import"./scrollable-COTa0yl_.js";import"./pageSignQR-99Bv1MS4.js";import"./textToSvgURL-Cnw_Q8Rw.js";let i=null,h=null,I=null,s,r,p,u;const y=()=>{setTimeout(()=>{p?.remove(),u?.remove()},300)},P=t=>{s.setAttribute("disabled","true");const o={phone_number:i.phone_number,phone_code_hash:i.phone_code_hash,phone_code:t};E.managers.apiManager.invokeApi("auth.signIn",o,{ignoreErrors:!0}).then(async e=>{switch(e._){case"auth.authorization":await E.managers.apiManager.setUser(e.user),m(()=>import("./pageIm-Dz55Dpoz.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(a=>{a.default.mount()}),y();break;case"auth.authorizationSignUpRequired":m(()=>import("./pageSignUp-BnXcZZUC.js"),__vite__mapDeps([4,1,2,5,3,6,7,8,9,10]),import.meta.url).then(a=>{a.default.mount({phone_number:i.phone_number,phone_code_hash:i.phone_code_hash})}),y();break}}).catch(async e=>{let a=!1;switch(e.type){case"SESSION_PASSWORD_NEEDED":a=!0,e.handled=!0,await(await m(()=>import("./pagePassword-BUHj7bf5.js"),__vite__mapDeps([11,1,2,10,3,7,12,6,5]),import.meta.url)).default.mount(),setTimeout(()=>{s.value=""},300);break;case"PHONE_CODE_EXPIRED":s.classList.add("error"),_(r.label,g("PHONE_CODE_EXPIRED"));break;case"PHONE_CODE_EMPTY":case"PHONE_CODE_INVALID":s.classList.add("error"),_(r.label,g("PHONE_CODE_INVALID"));break;default:r.label.innerText=e.type;break}a||r.select(),s.removeAttribute("disabled")})},N=()=>{if(c.pageEl.querySelector(".input-wrapper").append(r.container),l.getLoggedInInstanceIDs().length>0){const o=document.createElement("div"),e=w("close");e.addEventListener("click",async()=>{let n=l.getLoggedInInstanceIDs().find(b=>b==l.getLastInstanceId());n||(n=l.getLoggedInInstanceIDs()[0]),await l.destroyInstance(l.getActiveInstanceID()),await l.switchToInstance(n)}),o.append(e),c.pageEl.querySelector(".auth-image").parentElement.prepend(o)}const t=c.pageEl.querySelector(".phone-edit");t.append(O("edit")),T(t,()=>k.mount())},F=()=>{const t=c.pageEl.querySelector(".auth-image"),o=S.isMobile?100:166;if(i.type._==="auth.sentCodeTypeFragmentSms"){t.firstElementChild&&(p?.remove(),p=void 0,t.replaceChildren());const e=document.createElement("div");return e.classList.add("media-sticker-wrapper"),t.append(e),C.loadAnimationAsAsset({container:e,loop:!0,autoplay:!0,width:o,height:o},"jolly_roger").then(a=>(u=a,C.waitForFirstFrame(a))).then(()=>{})}else return t.firstElementChild&&(u?.remove(),u=void 0,t.replaceChildren()),p=new A(r,o),t.append(p.container),p.load()},c=new D("page-authCode",!0,N,t=>{if(i=t,!h)h=c.pageEl.getElementsByClassName("phone")[0],I=c.pageEl.getElementsByClassName("sent-type")[0];else{s.value="";const n=document.createEvent("HTMLEvents");n.initEvent("input",!1,!0),s.dispatchEvent(n)}const o=i.type.length;r||(r=new L({label:"Code",name:f(),length:o,onFill:n=>{P(n)}}),s=r.input),r.options.length=o,h.innerText=i.phone_number;let e,a;const d=i.type;switch(d._){case"auth.sentCodeTypeSms":e="Login.Code.SentSms";break;case"auth.sentCodeTypeApp":e="Login.Code.SentInApp";break;case"auth.sentCodeTypeCall":e="Login.Code.SentCall";break;case"auth.sentCodeTypeFragmentSms":e="PhoneNumber.Code.Fragment.Info";const n=document.createElement("a");v(n),n.href=d.url,a=[n];break;default:e="Login.Code.SentUnknown",a=[d._];break}return _(I,g(e,a)),E.managers.appStateManager.pushToState("authState",{_:"authStateAuthCode",sentCode:t}),F().catch(()=>{})},()=>{s.focus()});export{c as default};
//# sourceMappingURL=pageAuthCode-DRFBn4cK.js.map
